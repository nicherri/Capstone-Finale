<div *ngIf="product" class="container mt-4">
  <h2 class="mb-4">Modifica Prodotto: {{ product.title }}</h2>

  <!-- Sezione Immagini e Video -->
  <div class="row">
    <div class="col-md-6">
      <h3>Immagini e Video</h3>

      <!-- Immagini -->
      <div class="form-group mb-3">
        <label for="image">Carica Immagini:</label>
        <input id="image" type="file" class="form-control" (change)="onImageUpload($event)" multiple />
      </div>

      <div class="row">
        <div *ngFor="let image of product?.images" class="col-md-4">
          <img [src]="image.coverImageUrl" alt="Immagine prodotto" class="img-fluid mb-2" />
          <button class="btn btn-danger btn-sm" (click)="removeImage(image)">Rimuovi</button>
        </div>
      </div>

      <button class="btn btn-primary mt-2" (click)="saveImages()">Salva Immagini</button>

      <!-- Video -->
      <div class="form-group mb-3">
        <label for="video">Carica Video:</label>
        <input id="video" type="file" class="form-control" (change)="onVideoUpload($event)" multiple />
      </div>

      <div class="row">
        <div *ngFor="let video of product?.videos" class="col-md-12">
          <video controls class="w-100 mb-2">
            <source [src]="video.videoUrl" type="video/mp4" />
            Il tuo browser non supporta i video.
          </video>
        </div>
      </div>

      <button class="btn btn-primary mt-2" (click)="saveVideos()">Salva Video</button>
    </div>

    <!-- Colonna per i dettagli del prodotto -->
    <div class="col-md-6">
      <h3>Modifica Informazioni Prodotto</h3>

      <!-- Titolo -->
      <div class="form-group mb-3">
        <label for="title">Titolo:</label>
        <input id="title" class="form-control" [(ngModel)]="product.title" placeholder="Titolo" />
      </div>

      <!-- Prezzo -->
      <div class="form-group mb-3">
        <label for="price">Prezzo:</label>
        <input id="price" class="form-control" [(ngModel)]="product.price" type="number" placeholder="Prezzo" />
      </div>

      <!-- Descrizione -->
      <div class="form-group mb-3">
        <label for="description">Descrizione:</label>
        <app-quill-text-editor [(ngModel)]="product.description"></app-quill-text-editor>
      </div>

      <!-- Selezione Categoria -->
      <div class="form-group mb-3">
        <label for="category">Categoria:</label>
        <select id="category" class="form-select" [(ngModel)]="product.categoryId">
          <option *ngFor="let category of categories" [value]="category.id">{{ category.name }}</option>
        </select>
      </div>

      <!-- Pulsante per salvare il prodotto -->
      <button class="btn btn-primary" (click)="updateProduct()">Salva Modifiche Prodotto</button>
    </div>
  </div>

  <!-- Sezione Benefici -->
<div class="mt-4">
  <h3>Benefici</h3>
  <ul class="list-group">
    <li *ngFor="let benefit of product?.benefits; let i = index" class="list-group-item">
      <div class="input-group mb-2">
        <textarea [(ngModel)]="benefit.description" class="form-control" placeholder="Descrizione del beneficio"></textarea>
        <div class="input-group-append">
          <button class="btn btn-success" (click)="updateBenefit(benefit)">Salva</button>
          <button class="btn btn-danger" (click)="removeBenefit(benefit.id)">Rimuovi</button>
        </div>
      </div>
    </li>
  </ul>

  <div class="input-group mt-2">
    <app-quill-text-editor [(ngModel)]="Benefit.description" placeholder="Nuovo beneficio"></app-quill-text-editor>
    <div class="input-group-append">
      <button class="btn btn-success" (click)="addBenefit()">Aggiungi Beneficio</button>
    </div>
  </div>
</div>

<!-- Sezione FAQ -->
<div class="mt-4">
  <h3>FAQ</h3>
  <div *ngFor="let faq of product?.faqs; let i = index" class="mb-2">
    <label>Domanda</label>
    <textarea [(ngModel)]="faq.question" class="form-control" placeholder="Inserisci domanda"></textarea>
    <label>Risposta</label>
    <textarea [(ngModel)]="faq.answer" class="form-control" placeholder="Inserisci risposta"></textarea>
    <button class="btn btn-danger mt-2" (click)="removeFAQ(faq.id)">Rimuovi FAQ</button>
  </div>

  <div class="input-group mt-3">
    <textarea class="form-control" [(ngModel)]="newFAQ.question" placeholder="Nuova domanda"></textarea>
    <textarea class="form-control mt-2" [(ngModel)]="newFAQ.answer" placeholder="Nuova risposta"></textarea>
    <button class="btn btn-success mt-2" (click)="addFAQ()">Aggiungi FAQ</button>
  </div>
</div>



  <!-- Sezione Recensioni -->
  <div class="mt-4">
    <h3>Recensioni</h3>
    <div *ngFor="let review of product.reviews" class="mb-3">
      <div class="form-group">
        <label>Utente: {{ review.user?.nome }}</label>
      </div>
      <div class="form-group">
        <label>Valutazione:</label>
        <input class="form-control" [(ngModel)]="review.rating" type="number" min="0" max="5" />
      </div>
      <div class="form-group">
        <label>Commento:</label>
        <textarea class="form-control" [(ngModel)]="review.comment"></textarea>
      </div>

      <div *ngIf="review.reviewImages.length > 0">
        <p>Immagini:</p>
        <img *ngFor="let image of review.reviewImages" [src]="image.coverImageUrl" alt="Immagine recensione" class="img-fluid mb-2" />
      </div>

      <div *ngIf="review.reviewVideos.length > 0">
        <p>Video:</p>
        <video *ngFor="let video of review.reviewVideos" controls class="w-100 mb-2">
          <source [src]="video.videoUrl" type="video/mp4" />
        </video>
      </div>

      <button class="btn btn-primary" (click)="updateReview(review)">Salva Recensione</button>
      <button class="btn btn-danger" (click)="removeReview(review.id)">Rimuovi Recensione</button>
    </div>
  </div>
</div>
